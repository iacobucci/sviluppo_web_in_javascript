---
marp: true
paginate: true
---

<script src="../node_modules/mermaid/dist/mermaid.min.js"></script>
<script>mermaid.initialize({startOnLoad:true, theme:"neutral", mirrorActors:false});</script>

<link rel="stylesheet" href="res/styles.css">
<link rel="stylesheet" href="res/fontawesome.css">

<!-- _paginate: false -->

# Sviluppo web con Javascript

### Valerio Iacobucci ([@iacobucci](https://github.com/iacobucci))

![bg right cover](res/javascript.svg)

1. **Scripting**
2. **Browser**
3. **Controller**
4. **Model**
5. **View**

---

<!-- _backgroundColor: var(--main-color) -->
<!-- _color: white -->
<!-- _paginate: false -->

# Lezione 1

## Scripting

---

L'obiettivo del corso è imparare a sviluppare applicazioni distribuibili al maggior numero di utenti e senza frizione, con strumenti *essenziali*, facili da approcciare, potenzialmente scalabili, moderni, documentati e partecipati, che hanno una buona aspettativa di supporto in futuro, liberi.
<div class="container">
<div class="content" style="align-items: unset">

### Applicazioni web

- distribuzione multi-piattaforma ed aggiornamenti continui.
- utilizzo delle api del browser.
- *pwa*, *spa*, *ssr*...
- advertising.


</div>
<div class="content" style="align-items: unset">

### Javascript
- unico linguaggio di programmazione.
- facile gestione delle risorse.
- più paradigmi (imperativo, oop, funzionale, reattivo).

</div>

<div class="content" style="align-items: unset">

### Tecnologie open source
- partecipazione alla comunità.
- security through transparency.
- free as in freedom.


</div>
</div>

---

## Consulta anche

### Canali youtube
- [**The coding train**](https://www.youtube.com/@TheCodingTrain): tutorial di coding creativo.
- [**Fireship**](https://www.youtube.com/@Fireship): guide rapide per stare al passo con tecnologie moderne.

### References
- [**W3schools**](https://www.w3schools.com): tutorial introduttivi su ogni argomento web.
- [**Mdn web docs**](https://developer.mozilla.org): documentazione ufficiale di Mozilla.
- [**Ecma international**](https://www.ecma-international.org): standardizzazione di Javascript.

### Piattaforme di condivisione
- [**Codepen**](https://codepen.io): portfolio di applicazioni front-end.
- [**Github**](https://github.com): repository di progetti open source.

---

# Caso di studio

Svilupperemo un sistema gestionale per *amministrazione di condomini* e di pagamenti delle imposte. Mostriamo un **diagramma dei casi d'uso**.
<br>

<div class="content">
<div class="mermaid" style="width: 45%">
%%{init: {'theme': 'neutral', 'mirrorActors': false } }%%
flowchart LR
	USER[Utente] --> REGISTRAZIONE[Registrazione]
	REGISTRAZIONE --> LOGIN[Login]
	ADMIN[Amministratore] --> LOGIN
	DASHBOARD --> VISUALCONDO
	DASHBOARD --> GESTCONDO
	subgraph Admin
		GESTCONDO[Gestisci Condominio] --> GESTRES
		GESTRES[Gestisci Residenti] --> GESTPAGAM[Gestisci Pagamento]
	end
	subgraph Utente
		VISUALCONDO[Visualizza Condominio] --> VISUALPAGAM[Visualizza Pagamento]
	end
	LOGIN --> DASHBOARD[Dashboard]
	style USER fill:#224466,color:#fff
	style ADMIN fill:#224466,color:#fff

</div>
</div>

<br>
<br>

Gli *attori*, utenti e amministratori, saranno interfacciati con una **pagina web**, che comunica con un **server** che gestisce i dati. La pagina web sarà accessibile da ogni **browser** abbastanza aggiornato. Iniziamo a smanettare con il codice!

---

## Linux

È il sistema operativo di riferimento del corso per comandi shell, come sistema per **sviluppare** e per **distribuire** le applicazioni usando _Node_ per realizzare il server.

> Se usate Windows occorre il Subsystem for Linux. Aprite Powershell come amministratore e digitate:
>
> ```powershell
> wsl --install # riavviate
> wsl
> ```

> ```shell
> apt update
> apt install nodejs npm docker git
> ```

> Mac os è un parente più stretto a Linux, potete usare le funzionalità _Unix_ dal terminale ed installare node con Homebrew:
>
> ```shell
> /bin/bash -c "$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/HEAD/install.sh)"
> brew install node docker git
> ```

---

## Visual studio Code

Visual studio Code è un editor di testo (basato anche lui su Javascript!) con evidenziamento della sintassi, completamento automatico, debugger, integrazione con git ed estensioni della comunità.

La palette dei comandi è accessibile con `ctrl+shift+p` o `cmd+shift+p`.

> Da windows installate l'estensione WSL e connettetevi al vostro sottosistema linux con `WSL: Connect to WSL` dalla palette dei comandi.

Installiamo le estensioni

- [Html CSS Support](https://marketplace.visualstudio.com/items?itemName=ecmel.vscode-html-css)
- [Eslint](https://marketplace.visualstudio.com/items?itemName=dbaeumer.vscode-eslint)

---

## Node.js

È un ambiente di esecuzione di Javascript. Invocatelo da riga di comando con `node`. Usate il terminale di vscode (controllate nella palette comandi `ctrl+shift+p -> create new terminal`) per la modalità *read evaluate print loop*.

```shell
Welcome to Node.js v20.8.1.
Type ".help" for more information.
> console.log("Hello, world!")
```

Oppure può essere usato per eseguire script Javascript. Create un nuovo file in vscode con contenuto `console.log("Hello, World")` e salvatelo come `test.js`:

```shell
node test.js
```

---

# Scripting

Un programma Javascript è una sequenza di **istruzioni**, che sono eseguite in un ordine, e che possono modificare lo _stato_ del programma.

<br>
<div class="content">
<div class="mermaid" style="width: 45%">
%%{init: {'theme': 'neutral', 'mirrorActors': false } }%%
graph LR
	A[Inizio] --> B[istruzione 1]
	B --> C{Condizione}
	C -- soddisfatta  --> D[istruzione 2]
	C -- non soddisfatta --> E[istruzione 3]
	E -- loop --> B
	D --> F[Fine]
</div>
</div>

<br>
<br>

Ad ogni momento l'esecuzione **single threaded** valuta *una istruzione* alla volta.
C'è anche un **event loop non bloccante** che permette di gestire eventi asincroni.

---

## Variabili

Rappresentano lo stato del programma, sono **nomi** riferiti ad un **valore**.

```javascript
let x; // dichiarazione di una variabile, inizialmente è *undefined*
x = 10; // assegnamento

let saluto = "Hello, world!"; // dichiarazione e assegnamento

x = "Ciao, mondo!"; // riassegnamento (dinamico)
x = saluto; // riassegnamento di una variabile (copia)

const PI = 3.1415; // costante, non può essere riassegnata
let x = 11; // SyntaxError!
PI = 3.14; // TypeError!
```

<div class="content">

| Undefined   | Null   | Number | String   | Boolean | Object         |
| ----------- | ------ | ------ | -------- | ------- | -------------- |
| `let x;`    | `null` | `10`   | `"Ciao"` | `true`  | `{}` |
| `undefined` |        | `3.14` | `'Ciao'` | `false` | `new Object();`           |

</div>

---

## Scoping

Le variabili possono essere **locali** rispetto ad un blocco di codice: se sono dichiarate all'interno di un blocco, non sono *visibili* all'esterno.

```javascript
let pi = 3.1415;
{
	// blocco di codice, **isola** l'ambiente lessicale
	console.log(pi); // 3.1415
	let e = 2.7182;
	{
		let e = 2.718281;
		console.log(e); // 2.718281
	}
	console.log(e); // 2.7182
}
console.log(pi); // 3.1415
console.log(e); // ReferenceError!
```

---

## Operazioni

```javascript
let somma = 1 + 2;
let differenza = 1 - 2;
let prodotto = 1 * 2;
let quoziente = 1 / 2;
let modulo = 5 % 2; // 1, resto della divisione intera

let operazione = 1 + 2 * 3; // 7, moltiplicazione prima della somma
let precedenza = (1 + 2) * 3; // 9, parentesi prima della moltiplicazione

let i = 1;
i++; // i = i + 1; i = 2
i--; // i = i - 1; i = 1
i += 10; // i = i + 10; i = 11

let concatenazione = "Hello, " + "world!"; // "Hello, world!"
```

<div class="content">
<div  style="transform: scale(0.85)">

`Math.cos(n)`|`Math.sin(n)`|`Math.exp(n)`|`Math.log(n)`|`Math.sqrt(n)`|`Math.pow(b, e)`
---|---|---|---|---|---
</div>
</div>

---

### Operazioni booleane

Con combinazioni di queste si può rappresentare qualsiasi *funzione logica*.

```javascript
let a = true;
let b = false;

!a; /* not */   a && b; /* and */   a || b; /* or */

!(a && b); // not (a and b) = a nand b
```

<div class="container">
<div class="content">

| A       | !       |
| ------- | ------- |
| `false` | `true`  |
| `true`  | `false` |

</div>

<div class="content">

| A       | B       | &&      |
| ------- | ------- | ------- |
| `false` | `false` | `false` |
| `false` | `true`  | `false` |
| `true`  | `false` | `false` |
| `true`  | `true`  | `true`  |

</div>
<div class="content">

| A       | B       | &#124;&#124; |
| ------- | ------- | ------------ |
| `false` | `false` | `false`      |
| `false` | `true`  | `true`       |
| `true`  | `false` | `true`       |
| `true`  | `true`  | `true`       |

</div>
</div>

---

## Controllo del flusso

Le operazioni di *comparazione tra Number* `<`, `>`, `==`, `>=`, `<=`, `!=` hanno come risultato un valore booleano, che può essere usato per controllare il flusso.

<div class="container">
<div class="content" style="align-items: unset">

```javascript
if (eta >= 25) {
	console.log("Puoi diventare deputato");
} else if (eta >= 18) {
	console.log("Puoi votare");
} else {
	console.log("Non puoi votare");
}
```

</div>
<div class="content" style="align-items: unset">

```javascript
if (eta >= 25) {
	console.log("Puoi diventare deputato");
}
if (eta < 25 && eta >= 18) {
	console.log("Puoi votare");
}
if (eta < 18) {
	console.log("Non puoi votare");
}
```

</div>
</div>

I due esempi sono equivalenti. C'è anche l'operatore *ternario* `(cond) ? /* condizione vera */ : /* condizione falsa */`:

```javascript
(eta > 25) ? /*deputato*/ : ( (eta > 18) ? /*vota*/ : /*non vota*/ )
```

---

## Cicli

Un ciclo è un costrutto che permette di **ripetere** un blocco di istruzioni.

### For

È comodo per i cicli a **terminazione prevedibile**.

```javascript
let riga;
let dim = 10;

// assegnamento, condizione di ciclo, istruzione a fine ciclo
for (let x = 0; x < dim; x++) {
	riga = ""; // nuova riga
	for (let y = 0; y < dim; y++) {
		riga += x * y + " "; // aggiungiamo alla riga il prodotto
	}
	console.log(riga);
}
```

Abbiamo _innestato_ due cicli.

---

### While

È comodo per i cicli a **terminazione non prevedibile**.

```javascript
let numero = 11;

let i = 2;
let primo = true;
while (true) {
	// condizione (sempre vera)
	if (i >= numero) {
		break; // esci fuori dal ciclo
	}
	if (numero % i == 0) {
		// se i resto della divisione è zero
		primo = false;
		break;
	}
	i++;
}
```

Usando la keyword `break` possiamo uscire dal ciclo _di livello più interno_.

---

## Funzioni

Sono procedure che possono essere dichiarate, *definite* e **chiamate** da altre parti del programma. Prendono come ingresso **parametri** e possono restituire un **valore di ritorno**.

```javascript
function somma(a, b) {
	return a + b;
}

let x = somma(1, 2); //chiamata
let y = somma(somma(1, 2), 3); // chiamata nidificata, dal più interno al più esterno

let differenza = function (a, b) { return a - b; };
let prodotto = (a, b) => a * b;

function fattoriale(n) {
	if (n == 0)
		return 1;
	else
		return n * fattoriale(n - 1); //chiamata ricorsiva, stack di chiamate
}
```

---

### Try-catch

Per gestire gli errori critici usiamo il costrutto `try-catch`.

```javascript
function divisione(a, b) {
	if (b == 0)
		throw "Divisione per zero!";
	else
		return a / b;
}

function main() {
	try {
		let x = divisione(1, 0);
		console.log("Abbiamo ottenuto " + x);
	} catch (e) {
		console.log(e); // Divisione per zero!
		return;
	} finally {
		console.log("Fine divisione"); // Fine divisione
	}

	console.log("Continuazione del programma");
}

main();
```

---

### Funzioni di callback

Sono funzioni che vengono *passate come argomento* ad un'altra funzione, e che vengono chiamate in un momento successivo.

```javascript
function differenza(a, b) {
	return a - b;
}

function operazione(a, b, callback) {
	return callback(a, b);
}

let x = operazione(1, 2, differenza); // -1

let y = operazione(1, 2, function (a, b) {
	return a * b;
}); // 2

let z = operazione(1, 2, (a, b) => a / b); // 0.5
```

---

## Debugger di Visual Studio Code

<div class="container">
<div class="content" style="max-width: 35%">

Permette di visionare le istruzioni in esecuzione, mettendoci un **breakpoint**.

1. `ctrl+shift+p`

2. `start debugging`

3. `node.js`

Anche il _Browser web_ ha un debugger, che vedremo più avanti.

</div>

<div class="content">
<img src="res/debugger.png" style="width: 120%; object-fit: contain ">
</div>
</div>
